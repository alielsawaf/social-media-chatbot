from flask import Flask, request
import requests
import os
from google import genai
app = Flask(__name__)

# ================== CONFIG (Railway Variables) ==================
# Ø§Ù„ØªÙˆÙƒÙ†Ø² Ø¯ÙŠ Ù‡ÙŠØªÙ… Ù‚Ø±Ø§Ø¡ØªÙ‡Ø§ Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Railway Variables Ù„Ù„Ø£Ù…Ø§Ù†
PAGE_ACCESS_TOKEN = os.environ.get("PAGE_ACCESS_TOKEN")
VERIFY_TOKEN = os.environ.get("VERIFY_TOKEN")
GEMINI_API_KEY = os.environ.get("GEMINI_API_KEY")

# Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
genai.configure(api_key=GEMINI_API_KEY)
model = genai.GenerativeModel('gemini-1.5-flash')

# ================== DATA ==================
FAQ_MAP = {
  "Ø§Ù„Ø±Ù†Ø¬Ø© ÙÙŠÙ‡Ø§ Ø¯ÙˆØ¯": "ÙÙ†Ø¯Ù… Ø¯Ù‡ Ù…Ø´ Ø¯ÙˆØ¯ØŒ Ø¯Ù‡ Ø¨ÙŠÙƒÙˆÙ† Ø·ÙÙŠÙ„ÙŠØ§Øª. Ø§Ù„Ø·ÙÙŠÙ„ÙŠØ§Øª ÙÙŠ Ø³Ù…ÙƒØ© Ø§Ù„Ø±Ù†Ø¬Ø© ØªÙˆØ¬Ø¯ ÙÙŠ Ø§Ù„ØªØ¬ÙˆÙŠÙ Ø§Ù„Ø¨Ø·Ù†ÙŠ Ù„Ø£Ù†Ù‡Ø§ ØªØ¯Ø®Ù„ ÙÙŠ Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø§Ù…ØªØµØ§Øµ ÙˆØ§Ù„ØªÙ…Ø«ÙŠÙ„ Ø§Ù„ØºØ°Ø§Ø¦ÙŠ Ù„Ù„Ø³Ù…ÙƒØ© ÙˆÙ‡ÙŠ Ù„Ø§ ØªØµÙŠØ¨ Ø§Ù„Ø¥Ù†Ø³Ø§Ù† ØªÙ…Ø§Ù…Ø§Ù‹ØŒ ÙˆØ²ÙŠØ§Ø¯Ø© ÙÙŠ Ø§Ù„ÙˆÙ‚Ø§ÙŠØ© ÙŠØªÙ… ØªØ¬Ù…ÙŠØ¯ Ø§Ù„Ø£Ø³Ù…Ø§Ùƒ Ø¹Ù†Ø¯ Ø¯Ø±Ø¬Ø© Ù…Ù† 35 Ø¥Ù„Ù‰ 40 ØªØ­Øª Ø§Ù„ØµÙØ± Ù„ØªØµØ¨Ø­ Ø§Ù„Ø·ÙÙŠÙ„ÙŠØ§Øª Ø¬Ø²Ø¡ Ù…Ù† Ø§Ù„Ø£Ù…Ø¹Ø§Ø¡ ÙˆÙ„Ø§ ØªØ¤Ø«Ø± Ø¹Ù„Ù‰ Ø¢ÙƒÙ„Ù‡Ø§. Ø§Ù„Ø¯ÙˆØ¯ Ø§Ù„Ø­ÙŠ Ù„Ùˆ Ù…ÙˆØ¬ÙˆØ¯ Ø¨ÙŠÙƒÙˆÙ† Ø®Ø·Ø± Ø¹Ù„Ù‰ ØµØ­Ø© Ø§Ù„Ø¥Ù†Ø³Ø§Ù† ÙˆØ¨ÙŠÙƒÙˆÙ† Ø¯Ù„ÙŠÙ„ Ø¥Ù† Ø§Ù„Ø³Ù…ÙƒØ© ØºÙŠØ± ØµØ§Ù„Ø­Ø© Ù„Ù„Ø§Ø³ØªÙ‡Ù„Ø§Ùƒ. Ø§Ù„Ø³Ù…Ùƒ Ø²ÙŠ Ø§Ù„Ø¥Ù†Ø³Ø§Ù† Ù„Ù…Ø§ Ø¨ÙŠÙ…ÙˆØª Ø¨ÙŠÙ…Ø± Ø¨Ù…Ø±Ø§Ø­Ù„ØŒ Ù‚Ø¨Ù„ Ø¸Ù‡ÙˆØ± Ø¯ÙˆØ¯ Ø­ÙŠ Ù„Ø§Ø²Ù… ÙŠÙƒÙˆÙ† Ù…Ù†ØªÙØ® Ø«Ù… Ù…ØªØ¹ÙÙ† Ø«Ù… Ù…ØªÙ‡ØªÙƒØŒ ÙˆØ·Ø§Ù„Ù…Ø§ Ø§Ù„Ø³Ù…ÙƒØ© ØºÙŠØ± Ù…Ù†ØªÙØ®Ø© ÙˆÙ„Ø§ Ù…ØªØ¹ÙÙ†Ø© ÙˆÙ„Ø§ Ù…ØªÙ‡ØªÙƒØ© ÙØ¯ÙŠ Ø·ÙÙŠÙ„ÙŠØ§Øª Ø·Ø¨ÙŠØ¹ÙŠØ© Ø¨ÙŠØªØºØ°Ù‰ Ø¹Ù„ÙŠÙ‡Ø§ Ø§Ù„Ø³Ù…Ùƒ.",

  "Ù…Ù†ÙŠÙˆ": "Ø¯Ù‡ Ù„ÙŠÙ†Ùƒ Ù…Ù†ÙŠÙˆ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø¨ØªØ§Ø¹ØªÙ†Ø§: https://heyzine.com/flip-book/31946f16d5.html",

  "Ø§Ø²Ø§ÙŠ Ø§ØªØ£ÙƒØ¯ Ø§Ù† Ø§Ù„Ø±Ù†Ø¬Ø© Ø¯ÙŠ Ø±Ù†Ø¬Ø© Ø§Ø¨Ùˆ Ø§Ù„Ø³ÙŠØ¯": "Ø­Ø¶Ø±ØªÙƒ Ø­Ø§ÙˆÙ„ Ø´Ø±Ø§Ø¡ Ø±Ù†Ø¬Ø© Ø£Ø¨Ùˆ Ø§Ù„Ø³ÙŠØ¯ Ù…Ù† Ù…ØµØ§Ø¯Ø± Ù…ÙˆØ«ÙˆÙ‚Ø© Ù„Ø¶Ù…Ø§Ù† Ø­ØµÙˆÙ„Ùƒ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ø£ØµÙ„ÙŠ.",

  "Ø§Ù„Ø¬Ù…Ù„Ø© Ø§Ùˆ Ø§Ø³Ø¹Ø§Ø± Ø§Ù„Ø¬Ù…Ù„Ø©": "Ù„Ù„Ø§Ø³ØªÙØ³Ø§Ø± ÙˆØ·Ù„Ø¨ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¹Ù„Ù‰ Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù…ØµÙ†Ø¹: 01211113882",

  "Ø§Ù„Ø³Ù†Ø¯ÙˆØªØ´Ø§Øª": "Ù…Ù†ÙŠÙˆ Ø§Ù„Ø³Ø§Ù†Ø¯ÙˆÙŠØªØ´Ø§Øª ÙˆØ§Ù„Ø³Ù„Ø·Ø© ØºÙŠØ± Ù…ØªØ§Ø­ Ø­Ø§Ù„ÙŠØ§Ù‹ ÙˆÙ„Ø§ ÙŠÙˆØ¬Ø¯ ØªÙˆØµÙŠÙ„ Ù„Ù„Ø³Ø§Ù†Ø¯ÙˆÙŠØªØ´Ø§Øª ÙˆØ§Ù„Ø³Ù„Ø·Ø©.",

  "Ø§Ù„Ø³Ù„Ø·Ø©": "Ù…Ù†ÙŠÙˆ Ø§Ù„Ø³Ø§Ù†Ø¯ÙˆÙŠØªØ´Ø§Øª ÙˆØ§Ù„Ø³Ù„Ø·Ø© ØºÙŠØ± Ù…ØªØ§Ø­ Ø­Ø§Ù„ÙŠØ§Ù‹ ÙˆÙ„Ø§ ÙŠÙˆØ¬Ø¯ ØªÙˆØµÙŠÙ„ Ù„Ù„Ø³Ø§Ù†Ø¯ÙˆÙŠØªØ´Ø§Øª ÙˆØ§Ù„Ø³Ù„Ø·Ø©.",

  "Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„ÙØ±ÙˆØ¹": "Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„ Ù…Ù† Ø§Ù„Ø³Ø§Ø¹Ø© 10 ØµØ¨Ø§Ø­Ø§Ù‹ Ø­ØªÙ‰ Ø§Ù„Ø³Ø§Ø¹Ø© 12 Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„.",

  "Ø§Ù„ØªØµØ¯ÙŠØ±": "Ø­Ø¶Ø±ØªÙƒ ØªÙˆØ§ØµÙ„ ÙˆØ§ØªØ³Ø§Ø¨ Ù…Ø¹ Ø§Ù„Ø£Ø³ØªØ§Ø° Ø£Ø­Ù…Ø¯ Ø¹Ù„Ù‰ Ø±Ù‚Ù… 01272475555 ÙˆÙ‡Ùˆ Ù‡ÙŠØ³Ø§Ø¹Ø¯ Ø­Ø¶Ø±ØªÙƒ.",

  "Ø±Ù‚Ù… Ø§Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª": "Ø±Ù‚Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª: 01223066445",

  "Ø§Ù„ØªÙˆØ¸ÙŠÙ": "Ø±Ù‚Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù€ HR ÙÙŠ Ø¨ÙˆØ±Ø³Ø¹ÙŠØ¯: 01200056103",

  "Ù…Ù…ÙƒÙ† Ø§Ø´ÙˆÙŠ Ø§Ù„Ø±Ù†Ø¬Ø©": "Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø±Ù†Ø¬Ø© Ù„Ù„Ø´ÙˆÙŠ ÙˆÙ„Ø§ ØªØªØ¹Ø±Ø¶ Ù„Ø£ÙŠ Ø­Ø±Ø§Ø±Ø©ØŒ Ø±Ù†Ø¬Ø© Ø£Ø¨Ùˆ Ø§Ù„Ø³ÙŠØ¯ Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ø£ÙƒÙ„ Ù…Ø¨Ø§Ø´Ø±Ø© ÙˆÙ„Ø§ ÙŠÙ…ÙƒÙ† Ø¯Ù‡Ù†Ù‡Ø§ Ø¨Ø§Ù„Ø²ÙŠØª.",

  "Ø§Ù„ÙØ±Ù‚ Ø¨ÙŠÙ† Ø§Ù„Ø±Ù†Ø¬Ø© Ø§Ù„Ù…Ø¬Ù…Ø¯Ø© ÙˆØ§Ù„ÙØ±ÙŠØ´": "Ø§Ù„Ø±Ù†Ø¬Ø© Ø§Ù„Ù…Ø¬Ù…Ø¯Ø© ØªØ­ÙØ¸ ÙÙŠ Ø¯Ø±Ø¬Ø© Ø­Ø±Ø§Ø±Ø© -18 ÙˆØµÙ„Ø§Ø­ÙŠØªÙ‡Ø§ 3 Ø´Ù‡ÙˆØ± ÙˆÙŠØªÙ… Ø­ÙØ¸Ù‡Ø§ ÙÙŠ Ø§Ù„ØªØ¬Ù…ÙŠØ¯. Ø§Ù„Ø±Ù†Ø¬Ø© Ø§Ù„ÙØ±ÙŠØ´ ØªØ­ÙØ¸ ÙÙŠ Ø¯Ø±Ø¬Ø© Ø­Ø±Ø§Ø±Ø© Ù…Ù† 0 Ø¥Ù„Ù‰ 4 ÙˆØµÙ„Ø§Ø­ÙŠØªÙ‡Ø§ Ø´Ù‡Ø± ÙˆÙŠØªÙ… Ø­ÙØ¸Ù‡Ø§ ÙÙŠ Ø§Ù„ØªØ¨Ø±ÙŠØ¯.",

  "ÙˆØ²Ù† ÙƒØ±ØªÙˆÙ†Ø© Ø§Ù„Ø±Ù†Ø¬Ø© Ø§Ù„Ù…Ø¬Ù…Ø¯Ø©": "ÙˆØ²Ù† ÙƒØ±ØªÙˆÙ†Ø© Ø§Ù„Ø±Ù†Ø¬Ø© Ø§Ù„Ù…Ø¬Ù…Ø¯Ø© Ø¨ÙŠÙƒÙˆÙ† Ù…Ù† 7.5 Ø¥Ù„Ù‰ 8 ÙƒÙŠÙ„Ùˆ ÙŠØ§ ÙÙ†Ø¯Ù….",

  "Ø§Ù„ÙØ±Ù‚ Ø¨ÙŠÙ† Ø§Ù„ÙƒÙŠØ³ Ø§Ù„Ø§Ø³ÙˆØ¯ ÙˆØ§Ù„Ø¬ÙˆÙ„Ø¯ ÙØ§ÙƒÙŠÙˆÙ… ÙÙŠ Ø§Ù„ÙØ³ÙŠØ®": "Ø§Ù„Ø£Ø­Ø¬Ø§Ù… Ø§Ù„ØµØºÙŠØ±Ø© Ø¨ØªÙƒÙˆÙ† ÙÙŠ Ø§Ù„ØªØºÙ„ÙŠÙ Ø§Ù„Ø¬ÙˆÙ„Ø¯ ÙØ§ÙƒÙŠÙˆÙ… Ø¨Ø­Ø¯ Ø£Ù‚ØµÙ‰ 600 Ø¬Ø±Ø§Ù…ØŒ ÙˆØ§Ù„Ø£Ø­Ø¬Ø§Ù… Ø§Ù„Ø£ÙƒØ¨Ø± Ø¨ØªÙƒÙˆÙ† ÙÙŠ Ø§Ù„ØªØºÙ„ÙŠÙ Ø§Ù„Ø£Ø³ÙˆØ¯ ÙˆÙ…Ù…ÙƒÙ† ØªÙˆØµÙ„ Ù„ÙƒÙŠÙ„Ùˆ Ø£Ùˆ ÙƒÙŠÙ„Ùˆ Ùˆ200 Ø£Ùˆ 800 Ø¬Ø±Ø§Ù….",

  "Ø§Ù„ÙØ±Ù‚ Ø¨ÙŠÙ† Ø§Ù„Ø±Ù†Ø¬Ø© Ø§Ù„Ø¹Ø§Ø¯ÙŠØ© ÙˆØ¹ÙŠØ§Ø± 24": "Ø¹ÙŠØ§Ø± 24 Ø¹Ø¯Ø¯ Ø³Ø§Ø¹Ø§Øª Ø§Ù„ØªØ¯Ø®ÙŠÙ† ÙÙŠÙ‡ Ø£Ø·ÙˆÙ„ØŒ Ø­Ø¬Ù… Ø§Ù„Ø³Ù…ÙƒØ© Ø£ØµØºØ±ØŒ ÙˆØ·Ø¹Ù… Ø§Ù„ØªØ¯Ø®ÙŠÙ† Ù…Ø¹Ø²Ø² Ø£ÙƒØ«Ø± Ø¨Ø³Ø¨Ø¨ Ø²ÙŠØ§Ø¯Ø© Ø³Ø§Ø¹Ø§Øª Ø§Ù„ØªØ¯Ø®ÙŠÙ†.",

  "ÙƒÙŠÙÙŠØ© Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø§Ù„Ø±Ù†Ø¬Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø´Ø±Ø§Ø¡": "ÙŠÙØ¶Ù„ Ø­ÙØ¸ Ø§Ù„Ø±Ù†Ø¬Ø© ÙÙŠ Ø§Ù„ÙØ±ÙŠØ²Ø± Ø¨Ø¹Ø¯ Ø§Ù„Ø´Ø±Ø§Ø¡.",

  "ÙŠØ¹Ù†ÙŠ Ø§ÙŠÙ‡ Ø±Ù†Ø¬Ø© ÙØ§ÙƒÙŠÙˆÙ…": "Ø±Ù†Ø¬Ø© Ù…ØºÙ„ÙØ© ÙÙŠ Ø¹Ø¨ÙˆØ§Øª Ù…ÙØ±ØºØ© Ø§Ù„Ù‡ÙˆØ§Ø¡.",

  "Ø§Ù„ÙØ³ÙŠØ® Ø¨ÙŠØªÙ…Ù„Ø­ Ø§Ø²Ø§ÙŠ": "Ø§Ù„ÙØ³ÙŠØ® ÙŠØªÙ… ØªØµÙ†ÙŠØ¹Ù‡ Ù…Ù† Ø³Ù…Ùƒ Ø§Ù„Ø¨ÙˆØ±ÙŠØŒ ÙŠØªÙ… ØªÙ…Ù„ÙŠØ­Ù‡ ÙØ±ÙŠØ´ Ù„ÙˆÙ‚Ù Ø§Ù„Ù†Ù…Ùˆ Ø§Ù„Ø¨ÙƒØªÙŠØ±ÙŠØŒ ØªÙ…Ù„ÙŠØ­ Ø¬Ø§ÙØŒ ÙˆÙŠØ­ÙØ¸ ÙÙŠ Ø«Ù„Ø§Ø¬Ø§Øª Ø¨Ø¯Ø±Ø¬Ø§Øª Ø­Ø±Ø§Ø±Ø© Ù…Ù† 0 Ø¥Ù„Ù‰ 4.",

  "Ø§Ù„ÙØ±Ù‚ Ø¨ÙŠÙ† Ù„Ø­Ù… Ø§Ù„ØªÙˆÙ†Ø© Ø§Ù„Ø§Ø¨ÙŠØ¶ ÙˆØ§Ù„Ø§Ø­Ù…Ø±": "Ø§Ù„Ù„Ø­Ù… Ø§Ù„Ø£Ø¨ÙŠØ¶ Ø£ÙØªØ­ Ù…Ù† Ø§Ù„Ø£Ø­Ù…Ø± Ù„Ø£Ù† Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£Ø­Ù…Ø± Ù†Ø§ØªØ¬ Ø¹Ù† Ø§Ù„Ù…ÙŠÙˆØ¬Ù„ÙˆØ¨ÙŠÙ† ÙˆØ§Ù„Ù‡ÙŠÙ…ÙˆØ¬Ù„ÙˆØ¨ÙŠÙ†ØŒ ÙˆØ§Ù„Ù„Ø­Ù… Ø§Ù„Ø£Ø­Ù…Ø± ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù†Ø³Ø¨Ø© Ø¨Ø±ÙˆØªÙŠÙ† Ø£Ø¹Ù„Ù‰ ÙˆÙŠÙƒÙˆÙ† Ø·Ø±ÙŠ Ø£ÙƒØ«Ø±.",

  "Ù„ÙŠÙ‡ Ø§Ù„ÙØ³ÙŠØ® Ø¨ÙŠÙƒÙˆÙ† ÙÙŠ Ø¯Ù…": "Ø§Ù„Ø³Ù…ÙƒØ© Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ø£ÙƒÙ„ØŒ ÙˆØ§Ù„Ø¯Ù… Ø¨ÙŠÙƒÙˆÙ† Ù†ØªÙŠØ¬Ø© Ø§Ù„ØªÙ…Ù„ÙŠØ­ Ø§Ù„ÙØ±ÙŠØ´ ÙˆØ§Ù„ØªØ¬Ù…ÙŠØ¯ØŒ ÙˆØ¹Ù†Ø¯ ÙÙƒ Ø§Ù„ØªØ¬Ù…ÙŠØ¯ Ø¨ØªØ¸Ù‡Ø± Ø§Ù„Ø³ÙˆØ§Ø¦Ù„.",

  "Ù„ÙŠÙ‡ Ø§Ù„Ø±Ù†Ø¬Ø© Ø§Ù„ÙÙŠÙ„ÙŠÙ‡ Ù†Ø§Ø´ÙØ©": "Ø§Ù„Ø±Ù†Ø¬Ø© Ø§Ù„ÙÙŠÙ„ÙŠÙ‡ Ø¨ØªÙƒÙˆÙ† Ù…Ø®Ù„ÙŠØ© ÙˆØ¨ØªØ§Ø®Ø¯ 3 Ø·Ø¨Ù‚Ø§Øª ØªØ¯Ø®ÙŠÙ† Ù„ØªØ¹Ø²ÙŠØ² Ø§Ù„Ø·Ø¹Ù… ÙˆØ¯Ù‡ Ø¨ÙŠØ®Ù„ÙŠÙ‡Ø§ Ø£Ù†Ø´Ù Ø´ÙˆÙŠØ©.",

  "Ø§Ù„ÙØ±Ù‚ Ø¨ÙŠÙ† Ø§Ù„Ø±Ù†Ø¬Ø© Ø§Ù„ÙÙŠÙ„ÙŠÙ‡ ÙˆØ§Ù„Ø¹Ø§Ø¯ÙŠØ©": "Ø§Ù„ÙÙŠÙ„ÙŠÙ‡ Ù…Ø®Ù„ÙŠØ© ÙˆØªÙ…Ø± Ø¨Ù…Ø±Ø§Ø­Ù„ ØªÙ…Ù„ÙŠØ­ ÙˆØªØ¯Ø®ÙŠÙ† Ù…ÙƒØ«Ù Ùˆ3 Ø·Ø¨Ù‚Ø§Øª Ø³Ù…ÙˆÙƒØŒ ÙˆØ¨ØªÙƒÙˆÙ† Ø£Ù†Ø´Ù ÙˆØ·Ø¹Ù…Ù‡Ø§ Ù…Ø®ØªÙ„Ù.",

  "Ù…Ø¯ÙŠØ± Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª": "Ø§Ù„Ø£Ø³ØªØ§Ø° Ù…Ø­Ù…Ø¯ Ø§Ù„Ø´Ù…Ø§Ø¹ Ù…Ø¯ÙŠØ± Ø§Ù„Ø­Ø³Ø§Ø¨Ø§ØªØŒ Ø±Ù‚Ù… Ø§Ù„ØªÙˆØ§ØµÙ„: 01204464066",

  "ØªÙˆØ±ÙŠØ¯ Ù„Ù„ÙÙ†Ø§Ø¯Ù‚ ÙˆØ§Ù„Ù…Ø·Ø§Ø¹Ù…": "Ø§Ù„Ø£Ø³ØªØ§Ø° Ø¨Ù„Ø§Ù„ Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„ØªÙˆØ±ÙŠØ¯ØŒ Ø±Ù‚Ù… Ø§Ù„ØªÙˆØ§ØµÙ„: 01221093951",

  "Ø§Ù„ÙØ±Ù‚ Ø¨ÙŠÙ† Ø§Ù„Ø³Ù„Ù…ÙˆÙ† Ø§Ù„ÙØ§ÙƒÙŠÙˆÙ… ÙˆØ§Ù„ÙƒÙŠØ³ Ø§Ù„Ø§Ø³ÙˆØ¯": "Ø§Ù„Ø§Ø®ØªÙ„Ø§Ù ÙÙŠ Ù„ÙˆÙ† Ø§Ù„Ù„Ø­Ù… Ø¨Ø³Ø¨Ø¨ Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„ØªØ¯Ø®ÙŠÙ† ÙˆØ§Ù„ØªÙ…Ù„ÙŠØ­ ÙˆØ§Ù„Ø·Ù‡ÙŠ ÙˆØ¯Ù‡ Ø¨ÙŠØ£Ø«Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø·Ø¹Ù….",

  "Ø§Ù„ØªÙˆÙ†Ø© Ù…Ø³ØªÙˆØ±Ø¯Ø© ÙˆÙ„Ø§ Ù…ØµØ±ÙŠ": "Ø§Ù„ÙƒØ§Ù†Ø² Ù…Ø³ØªÙˆØ±Ø¯ Ù„ÙƒÙ† Ø§Ù„ØªÙˆÙ†Ø© Ù†ÙØ³Ù‡Ø§ Ù…ØµØ±ÙŠØ© ÙˆÙŠØªÙ… ØµÙŠØ¯Ù‡Ø§ Ù…Ù† Ø§Ù„Ø¨Ø­Ø± Ø§Ù„Ø£Ø¨ÙŠØ¶ Ø§Ù„Ù…ØªÙˆØ³Ø·.",

  "Ù„ÙŠÙ‡ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ØºØ§Ù„ÙŠØ©": "Ù„Ø£Ù†Ù†Ø§ Ø¨Ù†Ø¶Ù…Ù† Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ© ÙˆØ·Ø±ÙŠÙ‚Ø© ØªÙ…Ù„ÙŠØ­ ÙˆØªØ¯Ø®ÙŠÙ† Ù…Ø®ØªÙ„ÙØ©.",

  "ÙŠØ¹Ù†ÙŠ Ø§ÙŠÙ‡ ÙØ§ÙƒÙŠÙˆÙ…": "Ù…ØºÙ„Ù ÙÙŠ Ø¹Ø¨ÙˆØ§Øª Ù…ÙØ±ØºØ© Ø§Ù„Ù‡ÙˆØ§Ø¡.",

  "Ù†ÙˆØ¹ Ø§Ù„ØªÙˆÙ†Ø©": "ØªÙˆÙ†Ø© ÙŠÙ„ÙˆÙÙŠÙ†.",

  "Ø¨ØªØµØ·Ø§Ø¯ÙˆØ§ Ø§Ù„ØªÙˆÙ†Ø© Ù…Ù†ÙŠÙ†": "Ù…Ù† Ù…ØµØ± Ù…Ù† Ø§Ù„Ø¨Ø­Ø± Ø§Ù„Ø£Ø¨ÙŠØ¶ Ø§Ù„Ù…ØªÙˆØ³Ø·.",

  "Ø§Ù„ØªÙˆÙ†Ø© Ø²ÙŠØª ÙˆÙ„Ø§ Ù…ÙŠØ§Ù‡": "ÙƒÙ„ Ø§Ù„ØªÙˆÙ†Ø© Ù…Ø¹Ø¨Ø£Ø© ÙÙŠ Ø²ÙŠØª Ù†Ø¨Ø§ØªÙŠ ÙÙ‚Ø·.",

  "Ù‡Ù„ ÙÙŠ Ù…ÙˆØ§Ø¯ Ø­Ø§ÙØ¸Ø©": "ÙƒÙ„ Ù…Ù†ØªØ¬Ø§ØªÙ†Ø§ Ø¨Ø¯ÙˆÙ† Ù…ÙˆØ§Ø¯ Ø­Ø§ÙØ¸Ø©.",

  "Ù‡Ù„ Ù…Ù…ÙƒÙ† Ø§Ø³Ø®Ù† Ø§Ù„Ø±Ù†Ø¬Ø©": "Ø±Ù†Ø¬Ø© Ø£Ø¨Ùˆ Ø§Ù„Ø³ÙŠØ¯ Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªØ³Ø®ÙŠÙ†Ù‡Ø§ Ø£Ùˆ Ø·Ù‡ÙŠÙ‡Ø§ØŒ Ù‡ÙŠ Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ø£ÙƒÙ„.",

  "ØªÙˆØ§Ø¨Ù„ Ø§Ù„Ù…Ø§ÙƒØ±ÙŠÙ„ Ø§Ù„ÙÙŠÙ„ÙŠÙ‡": "ÙÙ„ÙÙ„ Ø£Ø³ÙˆØ¯ ÙˆÙÙ„ÙÙ„ Ø£Ø¨ÙŠØ¶.",

  "Ø¨Ø·Ø§Ø±Ø® Ø§Ù„Ø¨ÙˆØ±ÙŠ Ø¨Ø§Ù„Ø²Ø¨Ø¯Ø©": "Ø¨ØªÙƒÙˆÙ† Ø¨Ø·Ø§Ø±Ø® Ø¨ÙŠØ¶Ø§Ø¡ Ù†Ø´Ùˆ.",

  "Ø§Ù†ÙˆØ§Ø¹ Ø¨Ø·Ø§Ø±Ø® Ø§Ù„Ø±Ù†Ø¬Ø©": "Ù†ÙˆØ¹ Ù…Ø±Ù…Ù„Ø© Ù…Ù‡Ø±ÙˆØ³Ø© ÙˆÙ†ÙˆØ¹ Ù…Ø±Ù…Ù„Ø© ÙƒØ§Ù…Ù„Ø©.",

  "Ù‡Ù„ Ø§Ù„ØªÙˆÙ†Ø© Ø§Ù„Ù…Ø·Ù‡ÙŠØ© Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ø§ÙƒÙ„": "Ø§Ù„ØªÙˆÙ†Ø© Ø§Ù„Ù…Ø·Ù‡ÙŠØ© Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ø£ÙƒÙ„ Ø¨Ø¯ÙˆÙ† Ø²ÙŠØª Ø£Ùˆ Ù…ÙŠØ§Ù‡ ÙˆÙ…Ø­ÙÙˆØ¸Ø© ÙØ§ÙƒÙŠÙˆÙ… ÙˆØ¨Ø£ÙˆØ²Ø§Ù† Ù…Ø®ØªÙ„ÙØ©.",

  "Ù‡Ù„ ÙÙŠ Ø³Ù…Ùƒ Ù…Ø¬Ù…Ø¯ Ø¨Ø¯ÙˆÙ† ØªØµÙ†ÙŠØ¹": "Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø³Ù…Ùƒ Ù…Ø¬Ù…Ø¯ Ø¨Ø¯ÙˆÙ† ØªØµÙ†ÙŠØ¹ ÙÙŠ Ø§Ù„Ù…ØµÙ†Ø¹.",

  "Ù†ÙˆØ¹ Ø§Ù„Ø³Ù„Ù…ÙˆÙ† Ù„Ù„Ø·Ù‡ÙŠ": "Ø§Ù„Ø³Ù„Ù…ÙˆÙ† Ø§Ù„ÙÙŠÙ„ÙŠÙ‡ Ø§Ù„Ù†ÙŠ."
}

PRODUCT_MAP = {
  "Smoked Herring with Roe": "ðŸ’° Ø³Ø¹Ø± Ø±Ù†Ø¬Ø© Ù…Ø¯Ø®Ù†Ø© Ù…Ø¨Ø·Ø±Ø®Ø© Ù…Ø±Ù…Ù„Ø©:\nØ§Ù„ÙˆØ²Ù†: 1 KG\nØ§Ù„Ø³Ø¹Ø±: 250 EGP âœ¨",

  "Smoked Herring": "ðŸ’° Ø³Ø¹Ø± Ø±Ù†Ø¬Ø© Ù…Ø¯Ø®Ù†Ø©:\nØ§Ù„ÙˆØ²Ù†: 1 KG\nØ§Ù„Ø³Ø¹Ø±: 200 EGP âœ¨",

  "Smoked Herring 24 Kerat": "ðŸ’° Ø³Ø¹Ø± Ø±Ù†Ø¬Ø© Ù…Ø¯Ø®Ù†Ø© 24 Ù‚ÙŠØ±Ø§Ø·:\nØ§Ù„ÙˆØ²Ù†: 1 KG\nØ§Ù„Ø³Ø¹Ø±: 300 EGP âœ¨",

  "Smoked Herring 24 Kerat with Roe": "ðŸ’° Ø³Ø¹Ø± Ø±Ù†Ø¬Ø© Ù…Ø¯Ø®Ù†Ø© Ù…Ø¨Ø·Ø±Ø®Ø© Ù…Ø±Ù…Ù„Ø© 24 Ù‚ÙŠØ±Ø§Ø·:\nØ§Ù„ÙˆØ²Ù†: 1 KG\nØ§Ù„Ø³Ø¹Ø±: 320 EGP âœ¨",

  "Gutted Smoked Vacuumed Herring": "ðŸ’° Ø³Ø¹Ø± Ø±Ù†Ø¬Ø© Ù…Ø¯Ø®Ù†Ø© Ù…Ù†Ø²ÙˆØ¹Ø© Ø§Ù„Ø£Ø­Ø´Ø§Ø¡ ÙØ§ÙƒÙŠÙˆÙ…:\nØ§Ù„ÙˆØ²Ù†: 1 KG\nØ§Ù„Ø³Ø¹Ø±: 300 EGP âœ¨",

  "Smoked Vacuumed Herring with Roe": "ðŸ’° Ø³Ø¹Ø± Ø±Ù†Ø¬Ø© Ù…Ø¨Ø·Ø±Ø®Ø© Ù…Ø±Ù…Ù„Ø© ÙØ§ÙƒÙŠÙˆÙ…:\nØ§Ù„ÙˆØ²Ù†: 1 KG\nØ§Ù„Ø³Ø¹Ø±: 300 EGP âœ¨",

  "Smoked Herring in Vacuum Packing": "ðŸ’° Ø³Ø¹Ø± Ø±Ù†Ø¬Ø© Ù…Ø¯Ø®Ù†Ø© ÙØ§ÙƒÙŠÙˆÙ…:\nØ§Ù„ÙˆØ²Ù†: 1 KG\nØ§Ù„Ø³Ø¹Ø±: 275 EGP âœ¨",

  "Herring Fillets without Oil": "ðŸ’° Ø³Ø¹Ø± Ø±Ù†Ø¬Ø© ÙÙŠÙ„ÙŠÙ‡ Ø¨Ø¯ÙˆÙ† Ø²ÙŠØª:\nØ§Ù„ÙˆØ²Ù†: 1 KG\nØ§Ù„Ø³Ø¹Ø±: 600 EGP âœ¨",

  "Herring Fillets with Pepper Sauce and Caviar": "ðŸ’° Ø³Ø¹Ø± Ø±Ù†Ø¬Ø© ÙÙŠÙ„ÙŠÙ‡ Ø¨ØµÙˆØµ Ø§Ù„ÙÙ„ÙÙ„ ÙˆØ§Ù„ÙƒØ§ÙÙŠØ§Ø±:\nØ§Ù„ÙˆØ²Ù†: 200 G\nØ§Ù„Ø³Ø¹Ø±: 150 EGP âœ¨",

  "Herring Fillets with Sweet Sauce": "ðŸ’° Ø³Ø¹Ø± Ø±Ù†Ø¬Ø© ÙÙŠÙ„ÙŠÙ‡ Ø¨ØµÙˆØµ Ø§Ù„Ø³ÙƒØ±:\nØ§Ù„ÙˆØ²Ù†: 230 G\nØ§Ù„Ø³Ø¹Ø±: 180 EGP âœ¨",

  "Herring Fillets with Curry Sauce": "ðŸ’° Ø³Ø¹Ø± Ø±Ù†Ø¬Ø© ÙÙŠÙ„ÙŠÙ‡ Ø¨ØµÙˆØµ Ø§Ù„ÙƒØ§Ø±ÙŠ:\nØ§Ù„ÙˆØ²Ù†: 250 G\nØ§Ù„Ø³Ø¹Ø±: 250 EGP âœ¨",

  "Herring Fillets with Pepper Sauce": "ðŸ’° Ø³Ø¹Ø± Ø±Ù†Ø¬Ø© ÙÙŠÙ„ÙŠÙ‡ Ø¨ØµÙˆØµ Ø§Ù„ÙÙ„ÙÙ„:\nØ§Ù„ÙˆØ²Ù†: 250 G\nØ§Ù„Ø³Ø¹Ø±: 250 EGP âœ¨",

  "Herring Fillets with Vegetable Oil": "ðŸ’° Ø³Ø¹Ø± Ø±Ù†Ø¬Ø© ÙÙŠÙ„ÙŠÙ‡ Ø¨Ø§Ù„Ø²ÙŠØª Ø§Ù„Ù†Ø¨Ø§ØªÙŠ:\nØ§Ù„ÙˆØ²Ù†: 250 G\nØ§Ù„Ø³Ø¹Ø±: 250 EGP âœ¨",

  "Smoked Herring Fillets": "ðŸ’° Ø³Ø¹Ø± Ø±Ù†Ø¬Ø© ÙÙŠÙ„ÙŠÙ‡ Ù…Ø¯Ø®Ù†Ø©:\nØ§Ù„ÙˆØ²Ù†: 125 G\nØ§Ù„Ø³Ø¹Ø±: 85 EGP âœ¨",

  "Herring with Caviar Spread 200": "ðŸ’° Ø³Ø¹Ø± Ø±Ù†Ø¬Ø© Ù…Ø¹ ÙƒØ§ÙÙŠØ§Ø± Ø³Ø¨Ø±ÙŠØ¯:\nØ§Ù„ÙˆØ²Ù†: 200 G\nØ§Ù„Ø³Ø¹Ø±: 70 EGP âœ¨",

  "Herring with Caviar Spread 130": "ðŸ’° Ø³Ø¹Ø± Ø±Ù†Ø¬Ø© Ù…Ø¹ ÙƒØ§ÙÙŠØ§Ø± Ø³Ø¨Ø±ÙŠØ¯:\nØ§Ù„ÙˆØ²Ù†: 130 G\nØ§Ù„Ø³Ø¹Ø±: 70 EGP âœ¨",

  "Herring with Caviar Spread Tube": "ðŸ’° Ø³Ø¹Ø± Ø±Ù†Ø¬Ø© Ù…Ø¹ ÙƒØ§ÙÙŠØ§Ø± Ø³Ø¨Ø±ÙŠØ¯ ØªÙŠÙˆØ¨:\nØ§Ù„ÙˆØ²Ù†: 100 G\nØ§Ù„Ø³Ø¹Ø±: 70 EGP âœ¨",

  "Herring Roe with Vegetable Oil": "ðŸ’° Ø³Ø¹Ø± Ø¨Ø·Ø§Ø±Ø® Ø±Ù†Ø¬Ø© Ø¨Ø§Ù„Ø²ÙŠØª Ø§Ù„Ù†Ø¨Ø§ØªÙŠ Ù…Ø±Ù…Ù„Ø© ÙƒØ§Ù…Ù„Ø©:\nØ§Ù„ÙˆØ²Ù†: 250 G\nØ§Ù„Ø³Ø¹Ø±: 250 EGP âœ¨",

  "Herring Roe with Orange Sauce": "ðŸ’° Ø³Ø¹Ø± Ø¨Ø·Ø§Ø±Ø® Ø±Ù†Ø¬Ø© Ø¨ØµÙˆØµ Ø§Ù„Ø¨Ø±ØªÙ‚Ø§Ù„ Ù…Ø±Ù…Ù„Ø© Ù…Ù‡Ø±ÙˆØ³Ø©:\nØ§Ù„ÙˆØ²Ù†: 250 G\nØ§Ù„Ø³Ø¹Ø±: 250 EGP âœ¨",

  "Herring Roe with Honey Sauce": "ðŸ’° Ø³Ø¹Ø± Ø¨Ø·Ø§Ø±Ø® Ø±Ù†Ø¬Ø© Ø¨ØµÙˆØµ Ø§Ù„Ø¹Ø³Ù„ Ù…Ø±Ù…Ù„Ø© Ù…Ù‡Ø±ÙˆØ³Ø©:\nØ§Ù„ÙˆØ²Ù†: 250 G\nØ§Ù„Ø³Ø¹Ø±: 250 EGP âœ¨",

  "Herring Roe White": "ðŸ’° Ø³Ø¹Ø± Ù†Ø´Ùˆ Ø¨Ø·Ø§Ø±Ø® Ø±Ù†Ø¬Ø© Ø¨Ø§Ù„Ø²ÙŠØª Ø§Ù„Ù†Ø¨Ø§ØªÙŠ:\nØ§Ù„ÙˆØ²Ù†: 250 G\nØ§Ù„Ø³Ø¹Ø±: 250 EGP âœ¨",

  "Gutted Smoked Mackerel Salted": "ðŸ’° Ø³Ø¹Ø± Ù…Ø§ÙƒØ±ÙŠÙ„ Ù…Ø¯Ø®Ù† Ù…Ù…Ù„Ø­ Ù…Ù†Ø²ÙˆØ¹ Ø§Ù„Ø£Ø­Ø´Ø§Ø¡:\nØ§Ù„ÙˆØ²Ù†: 1 KG\nØ§Ù„Ø³Ø¹Ø±: 410 EGP âœ¨",

  "Smoked Salted Mackerel Vacuumed": "ðŸ’° Ø³Ø¹Ø± Ù…Ø§ÙƒØ±ÙŠÙ„ Ù…Ø¯Ø®Ù† Ù…Ù…Ù„Ø­ Ù…Ù†Ø²ÙˆØ¹ Ø§Ù„Ø£Ø­Ø´Ø§Ø¡ ÙØ§ÙƒÙŠÙˆÙ…:\nØ§Ù„ÙˆØ²Ù†: 1 KG\nØ§Ù„Ø³Ø¹Ø±: 460 EGP âœ¨",

  "Mackerel Fillets with Spices Vacuumed": "ðŸ’° Ø³Ø¹Ø± Ù…Ø§ÙƒØ±ÙŠÙ„ ÙÙŠÙ„ÙŠÙ‡ Ø¨Ø§Ù„ØªÙˆØ§Ø¨Ù„ ÙØ§ÙƒÙŠÙˆÙ…:\nØ§Ù„ÙˆØ²Ù†: 1 KG\nØ§Ù„Ø³Ø¹Ø±: 800 EGP âœ¨",

  "Mackerel Fillets Vacuumed": "ðŸ’° Ø³Ø¹Ø± Ù…Ø§ÙƒØ±ÙŠÙ„ ÙÙŠÙ„ÙŠÙ‡ Ø³Ø§Ø¯Ø© ÙØ§ÙƒÙŠÙˆÙ…:\nØ§Ù„ÙˆØ²Ù†: 1 KG\nØ§Ù„Ø³Ø¹Ø±: 800 EGP âœ¨",

  "Salted Grey Mullet with Vegetable Oil": "ðŸ’° Ø³Ø¹Ø± ÙÙŠÙ„ÙŠÙ‡ Ø¨ÙˆØ±ÙŠ Ù…Ù…Ù„Ø­ Ø²ÙŠØª Ù†Ø¨Ø§ØªÙŠ:\nØ§Ù„ÙˆØ²Ù†: 250 G\nØ§Ù„Ø³Ø¹Ø±: 250 EGP âœ¨",

  "Salted Grey Mullet with Smoked Oil": "ðŸ’° Ø³Ø¹Ø± ÙÙŠÙ„ÙŠÙ‡ Ø¨ÙˆØ±ÙŠ Ù…Ù…Ù„Ø­ Ø²ÙŠØª Ø¯Ø®Ø§Ù†:\nØ§Ù„ÙˆØ²Ù†: 250 G\nØ§Ù„Ø³Ø¹Ø±: 250 EGP âœ¨",

  "Salted Grey Mullet with Beet Sauce": "ðŸ’° Ø³Ø¹Ø± ÙØ³ÙŠØ® Ø³Ø¨Ø±ÙŠØ¯ Ø¨ØµÙˆØµ Ø§Ù„Ø¨Ù†Ø¬Ø±:\nØ§Ù„ÙˆØ²Ù†: 250 G\nØ§Ù„Ø³Ø¹Ø±: 250 EGP âœ¨",

  "Salted Grey Mullet with Curry Sauce": "ðŸ’° Ø³Ø¹Ø± ÙØ³ÙŠØ® Ø³Ø¨Ø±ÙŠØ¯ Ø¨ØµÙˆØµ Ø§Ù„ÙƒØ§Ø±ÙŠ:\nØ§Ù„ÙˆØ²Ù†: 250 G\nØ§Ù„Ø³Ø¹Ø±: 250 EGP âœ¨",

  "Salted Grey Mullet with Pepper Sauce": "ðŸ’° Ø³Ø¹Ø± ÙØ³ÙŠØ® Ø³Ø¨Ø±ÙŠØ¯ Ø¨ØµÙˆØµ Ø§Ù„ÙÙ„ÙÙ„:\nØ§Ù„ÙˆØ²Ù†: 250 G\nØ§Ù„Ø³Ø¹Ø±: 250 EGP âœ¨",

  "Smoked Salted Mullet": "ðŸ’° Ø³Ø¹Ø± Ø¨ÙˆØ±ÙŠ Ù…Ù…Ù„Ø­ Ù…Ø¯Ø®Ù† ÙØ³ÙŠØ®:\nØ§Ù„ÙˆØ²Ù†: 230 G\nØ§Ù„Ø³Ø¹Ø±: 150 EGP âœ¨",

  "Salted Mullet without Bacteria": "ðŸ’° Ø³Ø¹Ø± ÙØ³ÙŠØ® Ø¨Ø¯ÙˆÙ† Ø¨ÙƒØªÙŠØ±ÙŠØ§:\nØ§Ù„ÙˆØ²Ù†: 1 KG\nØ§Ù„Ø³Ø¹Ø±: 460 EGP âœ¨",

  "Salted Mullet with Roe": "ðŸ’° Ø³Ø¹Ø± ÙØ³ÙŠØ® Ù…Ø¨Ø·Ø±Ø® Ø¨Ø¯ÙˆÙ† Ø¨ÙƒØªÙŠØ±ÙŠØ§:\nØ§Ù„ÙˆØ²Ù†: 1 KG\nØ§Ù„Ø³Ø¹Ø±: 560 EGP âœ¨"
}

# ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ù€ AI (Ø§Ù„Ø¨Ø±ÙˆÙ…Ø¨Øª)
SYSTEM_INSTRUCTION = f"""
Ø£Ù†Øª Ù…Ø³Ø§Ø¹Ø¯ Ø®Ø¯Ù…Ø© Ø¹Ù…Ù„Ø§Ø¡ Ø°ÙƒÙŠ Ù„Ù…ØµÙ†Ø¹ "Ø±Ù†Ø¬Ø© Ø£Ø¨Ùˆ Ø§Ù„Ø³ÙŠØ¯". 
Ù…Ù‡Ù…ØªÙƒ Ø§Ù„Ø±Ø¯ Ø¹Ù„Ù‰ Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª Ø§Ù„Ø²Ø¨Ø§Ø¦Ù† Ø¨Ù„Ù‡Ø¬Ø© Ù…ØµØ±ÙŠØ© ÙˆØ¯ÙˆØ¯Ø© Ø¬Ø¯Ø§Ù‹ ÙˆØ§Ø³ØªØ®Ø¯Ù… ÙƒÙ„Ù…Ø© ÙŠØ§ÙÙ†Ø¯Ù… Ø¯Ø§Ø¦Ù…Ø§ ÙÙŠ ÙƒÙ„ Ø§Ù„Ø±Ø¯ÙˆØ¯ ÙˆÙ…Ù…Ù†ÙˆØ¹ Ø§Ù„ØªØ¹ØµØ¨ Ø§Ùˆ Ø§Ù„Ø§Ø³ØªÙ‡ØªØ§Ø± Ù†Ù‡Ø§Ø¦ÙŠ Ø¨ÙƒÙ„Ø§Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙˆØ¨Ø£Ø³Ù„ÙˆØ¨ "Ø§Ø­ØªØ±Ø§ÙÙŠ".
Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ© ÙÙ‚Ø· Ù„Ù„Ø±Ø¯:
1. Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©: {str(FAQ_MAP)}
2. Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø³Ø¹Ø§Ø±: {str(PRODUCT_MAP)}

Ù‚ÙˆØ§Ø¹Ø¯ Ù‡Ø§Ù…Ø©:
- Ø¥Ø°Ø§ Ø³Ø£Ù„ Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¹Ù† Ø³Ø¹Ø±ØŒ Ø§Ø¨Ø­Ø« Ø¹Ù†Ù‡ ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ÙˆØ£Ø¹Ø·Ù‡ Ø§Ù„Ø³Ø¹Ø± ÙˆØ§Ù„ÙˆØ²Ù†.
- Ø¥Ø°Ø§ Ù„Ù… ØªØ¬Ø¯ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© ÙÙŠ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§ØªØŒ Ø§Ø·Ù„Ø¨ Ù…Ù†Ù‡ Ø¨Ø°ÙƒØ§Ø¡ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø¹Ù„Ù‰ 01211113882.
- Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ (ðŸŸ, ðŸ’°, âœ¨).
- Ù„Ø§ ØªØ®ØªØ±Ø¹ Ø£Ø³Ø¹Ø§Ø±Ø§Ù‹ Ù…Ù† Ø¹Ù†Ø¯Ùƒ Ø£Ø¨Ø¯Ø§Ù‹.
"""

# ================== LOGIC ==================
def normalize(text):
    return text.lower().replace("Ø©", "Ù‡").replace("Ø£", "Ø§").replace("Ø¥", "Ø§").replace("Ø¢", "Ø§").strip()

def get_ai_answer(user_text):
    try:
        prompt = f"{SYSTEM_INSTRUCTION}\nØ§Ù„Ø¹Ù…ÙŠÙ„ ÙŠÙ‚ÙˆÙ„: {user_text}\nØ§Ù„Ø±Ø¯ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯:"
        response = model.generate_content(prompt)
        return response.text
    except:
        return "Ù…Ù†ÙˆØ±Ù†Ø§ ÙÙŠ Ø±Ù†Ø¬Ø© Ø£Ø¨Ùˆ Ø§Ù„Ø³ÙŠØ¯! Ù…Ù…ÙƒÙ† ØªÙˆØ¶Ø­ Ø³Ø¤Ø§Ù„Ùƒ Ø£ÙƒØªØ± Ø¹Ø´Ø§Ù† Ø£Ù‚Ø¯Ø± Ø£Ø³Ø§Ø¹Ø¯ÙƒØŸ"

def get_answer(text):
    q = normalize(text)
    
    # 1. ÙØ­Øµ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø© (FAQ) ÙŠØ¯ÙˆÙŠØ§Ù‹ Ø£ÙˆÙ„Ø§Ù‹ Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø³Ø±Ø¹Ø©
    for key, val in FAQ_MAP.items():
        if normalize(key) in q:
            return val

    # 2. ÙØ­Øµ ÙƒÙ„Ù…Ø§Øª Ù…ÙØªØ§Ø­ÙŠØ© Ù„Ù„Ø£Ø³Ø¹Ø§Ø±
    if "Ø³Ø¹Ø±" in q or "Ø¨ÙƒØ§Ù…" in q:
        if "ÙØ³ÙŠØ®" in q:
            return f"Ø£Ø³Ø¹Ø§Ø± Ø§Ù„ÙØ³ÙŠØ® Ø¹Ù†Ø¯Ù†Ø§:\n- {PRODUCT_MAP.get('Salted Mullet without Bacteria')}\n- {PRODUCT_MAP.get('Salted Mullet with Roe')}"
        if "Ø±Ù†Ø¬" in q:
            return f"Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø±Ù†Ø¬Ø© Ø¹Ù†Ø¯Ù†Ø§:\n- {PRODUCT_MAP.get('Smoked Herring')}\n- {PRODUCT_MAP.get('Smoked Herring 24 Kerat')}"

    # 3. Ù„Ùˆ Ù…Ù„Ù‚Ø§Ø´ Ø¥Ø¬Ø§Ø¨Ø© Ù…Ø¨Ø§Ø´Ø±Ø©ØŒ ÙŠØ¨Ø¹Øª Ù„Ù„Ù€ AI
    ai_reply = get_ai_answer(text)
    return ai_reply

def get_ai_answer(user_text):
    try:
        # ØªØ£ÙƒØ¯ Ø¥Ù† Ø§Ù„Ù€ API Key ÙˆØ§ØµÙ„ ÙØ¹Ù„Ø§Ù‹
        if not GEMINI_API_KEY:
            return "ÙŠØ§ ÙÙ†Ø¯Ù… Ù†ÙˆØ±ØªÙ†Ø§! ØªØ­Ø¨ ØªØ¹Ø±Ù Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø±Ù†Ø¬Ø© ÙˆÙ„Ø§ Ø§Ù„ÙØ³ÙŠØ®ØŸ (Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…ÙØªØ§Ø­)"
            
        prompt = f"{SYSTEM_INSTRUCTION}\nØ§Ù„Ø¹Ù…ÙŠÙ„ Ø¨ÙŠÙ‚ÙˆÙ„: {user_text}\nØ§Ù„Ø±Ø¯ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯:"
        response = model.generate_content(prompt)
        
        if response and response.text:
            return response.text
        else:
            return "Ù…Ù†ÙˆØ±Ù†Ø§ ÙÙŠ Ø±Ù†Ø¬Ø© Ø£Ø¨Ùˆ Ø§Ù„Ø³ÙŠØ¯! Ø£Ù‚Ø¯Ø± Ø£Ø³Ø§Ø¹Ø¯Ùƒ Ø¥Ø²Ø§ÙŠØŸ"
    except Exception as e:
        # Ø§Ù„Ø³Ø·Ø± Ø¯Ù‡ Ù‡ÙŠØ¸Ù‡Ø± ÙÙŠ Ø§Ù„Ù€ Console Logs Ø¨ØªØ§Ø¹Ø© Railway
        print(f"DEBUG: AI Error -> {e}")
        return "Ù…Ù†ÙˆØ±Ù†Ø§ ÙŠØ§ ØºØ§Ù„ÙŠ! Ù…Ù…ÙƒÙ† ØªÙˆØ¶Ø­ Ø³Ø¤Ø§Ù„Ùƒ Ø£ÙƒØªØ±ØŸ"
# ================== WEBHOOK ==================
@app.route("/webhook", methods=["GET"])
def verify():
    if request.args.get("hub.verify_token") == VERIFY_TOKEN:
        return request.args.get("hub.challenge")
    return "failed", 403

@app.route("/webhook", methods=["POST"])
def webhook():
    data = request.get_json()
    if data.get("object") == "page":
        for entry in data.get("entry", []):
            for ev in entry.get("messaging", []):
                sender = ev["sender"]["id"]
                if "message" in ev and "text" in ev["message"]:
                    msg_text = ev["message"]["text"]
                    reply = get_answer(msg_text)
                    send_message(sender, reply)
    return "ok", 200

def send_message(user_id, text):
    url = f"https://graph.facebook.com/v12.0/me/messages?access_token={PAGE_ACCESS_TOKEN}"
    payload = {"recipient": {"id": user_id}, "message": {"text": text}}
    requests.post(url, json=payload)

if __name__ == "__main__":
    app.run(host="0.0.0.0", port=int(os.environ.get("PORT", 8080)))




